<!DOCTYPE html>
<html>
<head>
 <link rel="stylesheet" href="minetest.css">
<head>
<body>
<p class="nav"><a href="index.html#contents">Contents</a>, <a href="full_index.html#Perlin_noise">Index</a></p>
<h1 id="Perlin noise">Perlin noise</h1>
<p>
Perlin noise creates a continuously-varying value depending on the input values. Usually in Minetest the input values are either 2D or 3D co-ordinates in nodes. The result is used during map generation to create the terrain shape, vary heat and humidity to distribute biomes, vary the density of decorations or vary the structure of ores.
</p>
<h2 id="Structure of perlin noise">Structure of perlin noise</h2>
<p>
An 'octave' is a simple noise generator that outputs a value between -1 and 1. The smooth wavy noise it generates has a single characteristic scale, almost like a 'wavelength', so on its own does not create fine detail. Due to this perlin noise combines several octaves to create variation on multiple scales. Each additional octave has a smaller 'wavelength' than the previous.
</p>
<p>
This combination results in noise varying very roughly between -2.0 and 2.0 and with an average value of 0.0, so <code>scale</code> and <code>offset</code> are then used to multiply and offset the noise variation.
</p>
<p>
The final perlin noise variation is created as follows:
</p>
<p>
noise = offset + scale * (octave1 +
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;octave2 * persistence +
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;octave3 * persistence ^ 2 +
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;octave4 * persistence ^ 3 +
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...)
</p>
<h2 id="Noise Parameters">Noise Parameters</h2>
<p>
Noise Parameters are commonly called <code>NoiseParams</code>.
</p>
<h3 id="offset"><code>offset</code></h3>
<p>
After the multiplication by <code>scale</code> this is added to the result and is the final step in creating the noise value. Can be positive or negative.
</p>
<h3 id="scale"><code>scale</code></h3>
<p>
Once all octaves have been combined, the result is multiplied by this. Can be positive or negative.
</p>
<h3 id="spread"><code>spread</code></h3>
<p>
For octave1, this is roughly the change of input value needed for a very large variation in the noise value generated by octave1. It is almost like a 'wavelength' for the wavy noise variation. Each additional octave has a 'wavelength' that is smaller than the previous octave, to create finer detail. <code>spread</code> will therefore roughly be the typical size of the largest structures in the final noise variation.
</p>
<p>
<code>spread</code> is a vector with values for x, y, z to allow the noise variation to be stretched or compressed in the desired axes. Values are positive numbers.
</p>
<h3 id="seed"><code>seed</code></h3>
<p>
This is a whole number that determines the entire pattern of the noise variation. Altering it enables different noise patterns to be created. With other parameters equal, different seeds produce different noise patterns and identical seeds produce identical noise patterns.
</p>
<p>
For this parameter you can randomly choose any whole number. Usually it is preferable for this to be different from other seeds, but sometimes it is useful to be able to create identical noise patterns.
</p>
<p>
In some noise APIs the world seed is added to the seed specified in noise parameters. This is done to make the resulting noise pattern vary in different worlds, and be 'world-specific'.
</p>
<h3 id="octaves"><code>octaves</code></h3>
<p>
The number of simple noise generators that are combined. A whole number, 1 or more. Each additional octave adds finer detail to the noise but also increases the noise calculation load. 3 is a typical minimum for a high quality, complex and natural-looking noise variation. 1 octave has a slight 'gridlike' appearence.
</p>
<p>
Choose the number of octaves according to the <code>spread</code> and <code>lacunarity</code>, and the size of the finest detail you require. For example: if <code>spread</code> is 512 nodes, <code>lacunarity</code> is 2.0 and finest detail required is 16 nodes, octaves will be 6 because the 'wavelengths' of the octaves will be 512, 256, 128, 64, 32, 16 nodes. Warning: If the 'wavelength' of any octave falls below 1 an error will occur.
</p>
<h3 id="persistence"><code>persistence</code></h3>
<p>
Each additional octave has an amplitude that is the amplitude of the previous octave multiplied by <code>persistence</code>, to reduce the amplitude of finer details, as is often helpful and natural to do so. Since this controls the balance of fine detail to large-scale detail <code>persistence</code> can be thought of as the 'roughness' of the noise.
</p>
<p>
A positive or negative non-zero number, often between 0.3 and 1.0. A common medium value is 0.5, such that each octave has half the amplitude of the previous octave. This may need to be tuned when altering <code>lacunarity</code>; when doing so consider that a common medium value is 1 / lacunarity.
</p>
<h3 id="lacunarity"><code>lacunarity</code></h3>
<p>
Each additional octave has a 'wavelength' that is the 'wavelength' of the previous octave multiplied by 1 / lacunarity, to create finer detail. 'lacunarity' is often 2.0 so 'wavelength' often halves per octave.
</p>
<p>
A positive number no smaller than 1.0. Values below 2.0 create higher quality noise at the expense of requiring more octaves to cover a paticular range of 'wavelengths'.
</p>
<h3 id="flags"><code>flags</code></h3>
<p>
Leave this field unset for no special handling. Currently supported are <code>defaults</code>, <code>eased</code> and <code>absvalue</code>:
</p>
<h4 id="defaults"><code>defaults</code></h4>
<p>
Specify this if you would like to keep auto-selection of eased/not-eased while specifying some other flags.
</p>
<h4 id="eased"><code>eased</code></h4>
<p>
Maps noise gradient values onto a quintic S-curve before performing interpolation. This results in smooth, rolling noise. Disable this (<code>noeased</code>) for sharp-looking noise with a slightly gridded appearence. If no flags are specified (or defaults is), 2D noise is eased and 3D noise is not eased. Easing a 3D noise significantly increases the noise calculation load, so use with restraint.
</p>
<h4 id="absvalue"><code>absvalue</code></h4>
<p>
The absolute value of each octave's noise variation is used when combining the octaves. The final perlin noise variation is created as follows:
</p>
<p>
noise = offset + scale * (abs(octave1) +
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abs(octave2) * persistence +
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abs(octave3) * persistence ^ 2 +
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abs(octave4) * persistence ^ 3 +
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...)
</p>
<h3 id="Format example">Format example</h3>
<p>
For 2D or 3D perlin noise or perlin noise maps:
</p>
&nbsp;&nbsp;&nbsp;&nbsp;np_terrain = {
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offset = 0,
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scale = 1,
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spread = {x = 500, y = 500, z = 500},
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seed = 571347,
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;octaves = 5,
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;persist = 0.63,
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lacunarity = 2.0,
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flags = "defaults, absvalue",
<br>
&nbsp;&nbsp;&nbsp;&nbsp;}
<p>
For 2D noise the Z component of <code>spread</code> is still defined but is ignored. A single noise parameter table can be used for 2D or 3D noise.
</p>
<p class="nav"><a href="index.html#contents">Contents</a>, <a href="full_index.html#Perlin_noise">Index</a></p>
<br>
</body>
</html>
